This is updated code and need to work on this code only.